# Hugo Andres Dorado B.
# 09-04-2018
rm(list = ls())
library(here)
library(data.table)
library(plyr)
library(Imap)
library(pgirmess)
source(here::here('SCRIPTS','Merge_Stations_Funs.R'))
load(here::here('RESULTS','Catalogs.RData'))
load(here::here('BASIC_FILES','list_Station_Unprocess.RData'))
lapply(list_Stations_Unprocess,head)
lapply(list_Stations_Unprocess[[1:3]],head)
lapply(list_Stations_Unprocess[1:3],head)
load(here::here('BASIC_FILES','list_Stations_Process.RData'))
lapply(list_Stations_Process[1:3],head)
300+25*6+50*4+100*2+300
rm(list = ls())
library(here)
library(data.table)
library(plyr)
library(Imap)
library(pgirmess)
source(here::here('SCRIPTS','Merge_Stations_Funs.R'))
load(here::here('RESULTS','Catalogs.RData'))
load(here::here('BASIC_FILES','list_Station_Unprocess.RData'))
load(here::here('BASIC_FILES','list_Stations_Process.RData'))
earlist_date_crop_cycle <- min(crop_cycles$Ini_Date)
lastest_data_crop_cycle <- max(crop_cycles$End_Date)
rule1 <- earlist_date_crop_cycle > Stations_catalog$Max_Date
rule2 <- lastest_data_crop_cycle < Stations_catalog$Min_Date
Stations_target <- Stations_catalog[!(rule1|rule2),]
crop_cycles <- crop_cycles[min(Stations_target$Min_Date) < crop_cycles$Ini_Date,]
merg_Station <- merge_Stations(Stations_target,crop_cycles,crop_cycle_Name= 'FID',
Dtemp  = 30000, Drain  = 15000,
Drhum  = 30000, Drads  = 30000,
DifElv = 150)
usefullStation <- merg_Station$usefullStation
crop_cycles <- crop_cycles[crop_cycles$FID %in% usefullStation$ID_crop_cycle,]
crop_cycle_vars_station_assignation <- assing_var_station(crop_cycles,usefullStation)
Final_weather_assign <- weather_assignation(crop_cycle_vars_station_assignation,list_Stations_Process)
lapply(crop_cycle_vars_station_assignation,head)
head(crop_cycle_vars_station_assignation)
fix(assing_var_station)
head(merg_Station)
requiere(rgdar)
require(rgdar)
require(rgdal)
shapeChiapas <- readOGR('//dapadfs/workspace_cluster_8/AEPS/CIMMYT_2016/GIS/Chiapas_mascara.shp')
plot(shapeChiapas)
par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
crop_cycle_vars_station_assignation
crop_cycles
points(crop_cycles$Latitude,crop_cycles$Longitude)
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
layout(1:2)
par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
layout(matrix(1:4),4,4)
par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
layout(matrix(1:4),4,4)
#par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
#par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
#par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
#par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
layout(matrix(1:4),4,4)
#par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
#par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
#par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
matrix(1:4,4,4)
layout(matrix(1:4,2,2))
#par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
#par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
#par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
#par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
layout(matrix(1:4,2,2))
par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
#layout(matrix(1:4,2,2))
par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
#layout(matrix(1:4,2,2))
par(mar=c(.1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
#layout(matrix(1:4,2,2))
par(mar=c(1,.1,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
#layout(matrix(1:4,2,2))
par(mar=c(5,.1,.1,.1))
plot(shapeChiapas)
#layout(matrix(1:4,2,2))
par(mar=c(.1,5,.1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
#layout(matrix(1:4,2,2))
par(mar=c(.1,.1,5,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
#layout(matrix(1:4,2,2))
par(mar=c(.1,.1,1,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
#layout(matrix(1:4,2,2))
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude)
#layout(matrix(1:4,2,2))
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas)
points(crop_cycles$Longitude,crop_cycles$Latitude,main='Puntos vs estaciones')
points(crop_cycles$Longitude,crop_cycles$Latitude,main='Puntos vs estaciones')
plot(shapeChiapas,main='Puntos vs estaciones')
points(crop_cycles$Longitude,crop_cycles$Latitude)
head(Stations_target)
?points
#layout(matrix(1:4,2,2))
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas,main='Puntos vs estaciones')
points(crop_cycles$Longitude,crop_cycles$Latitude)
points(Stations_target$Longitude,Stations_target$Latitude),type=2)
points(Stations_target$Longitude,Stations_target$Latitude,type=2)
Stations_target$Longitude
Stations_target$Latitude
points(Stations_target$Longitude,Stations_target$Latitude,pch=17)
#layout(matrix(1:4,2,2))
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)')
points(crop_cycles$Longitude,crop_cycles$Latitude)
points(Stations_target$Longitude,Stations_target$Latitude,pch=24,bg='white')
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)',xlab=c(-92.961,-92.085),ylab=c(14.53,15.217))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)',xlab=c(-92.961,-92.085),ylab=c(14.53,15.217))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)',xlim=c(-92.961,-92.085),ylim=c(14.53,15.217))
points(crop_cycles$Longitude,crop_cycles$Latitude)
points(Stations_target$Longitude,Stations_target$Latitude,pch=24,bg='white')
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)',xlim=c(-92.961,-92.085),ylim=c(14.53,15.217))
points(crop_cycles$Longitude,crop_cycles$Latitude)
points(Stations_target$Longitude,Stations_target$Latitude,pch=24,bg='white')
layout(rbind(1:2))
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)')
points(crop_cycles$Longitude,crop_cycles$Latitude)
points(Stations_target$Longitude,Stations_target$Latitude,pch=24,bg='white')
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)',xlim=c(-92.961,-92.085),ylim=c(14.53,15.217))
points(crop_cycles$Longitude,crop_cycles$Latitude)
points(Stations_target$Longitude,Stations_target$Latitude,pch=24,bg='white')
layout(rbind(1:2))
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)')
points(crop_cycles$Longitude,crop_cycles$Latitude)
points(Stations_target$Longitude,Stations_target$Latitude,pch=24,bg='white')
par(mar=c(.1,.1,3,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)\nChiapas sur',xlim=c(-92.961,-92.085),ylim=c(14.53,15.217))
points(crop_cycles$Longitude,crop_cycles$Latitude)
points(Stations_target$Longitude,Stations_target$Latitude,pch=24,bg='white')
Stations_target
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)')
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg='white')
crop_cycles_toPlot     <- crop_cycles
Stations_target_toPlot <- Stations_target
layout(rbind(1:2))
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)')
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg='white')
par(mar=c(.1,.1,3,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)\nChiapas sur',xlim=c(-92.961,-92.085),ylim=c(14.53,15.217))
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg='white')
Stations_target_toPlot
1:length(Stations_target_toPlot$Station_Name)
crop_cycles_toPlot     <- crop_cycles
Stations_target_toPlot <- Stations_target
Stations_target_toPlot$color <- 1:length(Stations_target_toPlot$Station_Name)
layout(rbind(1:2))
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)')
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg = Stations_target_toPlot$color)
Stations_target$Station_Name
unique(Stations_target$Station_Name)
head(Stations_target_toPlot)
require(rgdal)
shapeChiapas <- readOGR('//dapadfs/workspace_cluster_8/AEPS/CIMMYT_2016/GIS/Chiapas_mascara.shp')
crop_cycles_toPlot     <- crop_cycles
Stations_target_toPlot <- Stations_target
Stations_target_toPlot$color <- 1:length(Stations_target_toPlot$Station_Name)
layout(rbind(1:2))
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)')
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg = Stations_target_toPlot$color)
par(mar=c(.1,.1,3,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)\nChiapas sur',xlim=c(-92.961,-92.085),ylim=c(14.53,15.217))
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg='white',bg = Stations_target_toPlot$color)
Stations_target_toPlot$color
Stations_target_toPlot$Longitude
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg = Stations_target_toPlot$color)
windows()
layout(rbind(1:2))
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)')
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg = Stations_target_toPlot$color)
par(mar=c(.1,.1,3,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)\nChiapas sur',xlim=c(-92.961,-92.085),ylim=c(14.53,15.217))
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg = Stations_target_toPlot$color)
Stations_target_toPlot$Longitude
Stations_target_toPlot
Stations_target_toPlot$color
colors()
Stations_target_toPlot$color <-colors()[ 1:length(Stations_target_toPlot$Station_Name)]
crop_cycles_toPlot     <- crop_cycles
Stations_target_toPlot <- Stations_target
Stations_target_toPlot$color <-colors()[ 1:length(Stations_target_toPlot$Station_Name)]
layout(rbind(1:2))
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)')
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg = Stations_target_toPlot$color)
par(mar=c(.1,.1,3,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)\nChiapas sur',xlim=c(-92.961,-92.085),ylim=c(14.53,15.217))
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg = Stations_target_toPlot$color)
sample(colors(),length(Stations_target_toPlot$Station_Name))
crop_cycles_toPlot     <- crop_cycles
Stations_target_toPlot <- Stations_target
set.seed(123)
Stations_target_toPlot$color <- sample(colors(),length(Stations_target_toPlot$Station_Name))
layout(rbind(1:2))
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)')
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg = Stations_target_toPlot$color)
par(mar=c(.1,.1,3,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)\nChiapas sur',xlim=c(-92.961,-92.085),ylim=c(14.53,15.217))
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg = Stations_target_toPlot$color)
crop_cycles_toPlot     <- crop_cycles
Stations_target_toPlot <- Stations_target
set.seed(1239)
Stations_target_toPlot$color <- sample(colors(),length(Stations_target_toPlot$Station_Name),replace = F)
layout(rbind(1:2))
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)')
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg = Stations_target_toPlot$color)
par(mar=c(.1,.1,3,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)\nChiapas sur',xlim=c(-92.961,-92.085),ylim=c(14.53,15.217))
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg = Stations_target_toPlot$color)
crop_cycle_vars_station_assignation
names(crop_cycle_vars_station_assignation)
crop_cycle_vars_station_assignation[crop_cycle_vars_station_assignation$Variable=='TX']
crop_cycle_vars_station_assignation[crop_cycle_vars_station_assignation$Variable=='TX',]
head(ccStat)
ccStat <- crop_cycle_vars_station_assignation[crop_cycle_vars_station_assignation$Variable=='TX',]
head(ccStat)
head(Stations_target_toPlot)
head(ccStat)
merge(ccStat,Stations_target_toPlot[c('Station_Name','color')],by='Station_Name',all.x=T,all.y=F)
head(ccStat)
merge(ccStat,Stations_target_toPlot[c('Station_Name','color')],by.x='Station',by.y='Station_Name',all.x=T,all.y=F,sort=F)
head(ccStat)
crop_cycles_toPlot$crop_cycle
crop_cycles_toPlot$FID
ccStat$FID
ccStat$crop_cycle
shapeChiapas <- readOGR('//dapadfs/workspace_cluster_8/AEPS/CIMMYT_2016/GIS/Chiapas_mascara.shp')
crop_cycles_toPlot     <- crop_cycles
Stations_target_toPlot <- Stations_target
set.seed(1239)
Stations_target_toPlot$color <- sample(colors(),length(Stations_target_toPlot$Station_Name),replace = F)
ccStat <- crop_cycle_vars_station_assignation[crop_cycle_vars_station_assignation$Variable=='TX',]
ccStat <- merge(ccStat,Stations_target_toPlot[c('Station_Name','color')],by.x='Station',by.y='Station_Name',all.x=T,all.y=F,sort=F)
crop_cycles_toPlot <- merge(crop_cycles_toPlot,ccStat,by.x='FID',by.y='crop_cycle',all.x=T,all.y=F)
head(crop_cycles_toPlot)
layout(rbind(1:2))
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)')
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude,bg=crop_cycles_toPlot$color)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg = Stations_target_toPlot$color)
par(mar=c(.1,.1,3,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)\nChiapas sur',xlim=c(-92.961,-92.085),ylim=c(14.53,15.217))
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude,bg=crop_cycles_toPlot$color)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg = Stations_target_toPlot$color)
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude,color=crop_cycles_toPlot$color)
layout(rbind(1:2))
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)')
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude,color=crop_cycles_toPlot$color)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg = Stations_target_toPlot$color)
par(mar=c(.1,.1,3,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)\nChiapas sur',xlim=c(-92.961,-92.085),ylim=c(14.53,15.217))
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude,bg=crop_cycles_toPlot$color)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg = Stations_target_toPlot$color)
layout(rbind(1:2))
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)')
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude,color=crop_cycles_toPlot$color)
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)')
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude,bg=crop_cycles_toPlot$color)
layout(rbind(1:2))
par(mar=c(.1,.1,2,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)')
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude,pch=21,bg=crop_cycles_toPlot$color)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg = Stations_target_toPlot$color)
par(mar=c(.1,.1,3,.1))
plot(shapeChiapas,main='Puntos vs estaciones (Tmax)\nChiapas sur',xlim=c(-92.961,-92.085),ylim=c(14.53,15.217))
points(crop_cycles_toPlot$Longitude,crop_cycles_toPlot$Latitude,pch=21,bg=crop_cycles_toPlot$color)
points(Stations_target_toPlot$Longitude,Stations_target_toPlot$Latitude,pch=24,bg = Stations_target_toPlot$color)
knitr::opts_chunk$set(echo = TRUE)
rm(list = ls())
library(here)
library(data.table)
library(plyr)
library(Imap)
library(pgirmess)
source(here::here('SCRIPTS','Merge_Stations_Funs.R'))
load(here::here('BASIC_FILES','list_Station_Unprocess.RData'))
lapply(list_Stations_Unprocess[1:3],head)
knitr::opts_chunk$set(echo = TRUE)
rm(list = ls())
library(here)
library(data.table)
library(plyr)
library(Imap)
library(pgirmess)
source(here::here('SCRIPTS','Merge_Stations_Funs.R'))
load(here::here('RESULTS','Catalogs.RData'))
head(Stations_catalog)
head(crop_cycles)
install.packages('EnvStats')
